synchronized是Java中常用的线程同步实现方式，实现同步的两种情况：
* 同步方法。
* 同步代码块。

### 同步方法
synchronized修饰的方法会被编译成普通的方法。在JVM字节码层面并没有特别的指令来实现被synchronized修饰的方法，
而是在Class文件的方法表中将该方法的access_flags字段中的synchronized标志位设置成1，表示该方法是同步方法。  

当某个线程要访问某个方法的时候，将调用该方法的对象(普通方法同步)或该方法所属的Class(在JVM的内部对象表示Klass，静态方法同步，全局锁)做为监视器锁，
这时如果其他线程来请求执行方法，会因为无法获得监视器锁而被阻断住。  
>`注：如果在方法执行过程中，发生了异常，并且方法内部并没有处理该异常，那么在异常被抛到方法外面之前监视器锁会被自动释放。`

### 同步代码块
对于同步代码块，JVM采用monitorenter、monitorexit两个指令来实现同步。  
>`monitorenter指令插入到同步代码块的开始位置，monitorexit指令插入到同步代码块的结束位置。`  

JVM需要保证每一个monitorenter都有一个monitorexit与之相对应，这样就保证了执行monitorexit指令的线程是monitor监视器的所有者。  
>`根据虚拟机规范的要求，在执行monitorenter指令时，首先要尝试获取栈顶对象的锁。如果这个对象没有被锁定，或者当前线程已经拥有了那个对象的锁，把锁的计数器加1。
相应地，在执行monitorexit指令时会将栈顶对象锁计数器减1。当计数器为0时，锁就会被释放。
如果获取对象锁失败，那当前线程就要阻塞等待，直到对象锁被另外一个线程释放为止。`
